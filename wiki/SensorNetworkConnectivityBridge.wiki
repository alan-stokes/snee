#summary This page describes the commands used by the Sensor Network Connectivity Bridge.

= Introduction =

This page describes the commands used by the Sensor Network Connectivity Bridge.

= Dependencies =

  * TinyOS 2.1.1
  * SNEE set up according to [SettingUpDeveloperEnvironment these instructions]

= Setting up the Nodes =

The first thing that you need to do is install the Over-the-Air Programmer and Metadata Collector into slots 1 and 0 respectively of the External data flash, so that they can be booted into as required.

Slot 2 is reserved for the SNEE query plan that will be disseminated.

The code for these programs is located at SNEE/compiler/src/main/resources/etc/sncb/tools/nesC, relative to the root directory of the SNEE workspace.

== Install the OTA tool into the Nodes' External Flash Memory (Slot 1) ==

  * First, manually with a USB cable, add OTAServer to the non-basestation nodes, and OTABasestation to the basestation.
  {{{ make telosb install,<node_id> }}}

  * Then install the OTA image into each node except the basestation at slot 1
  {{{ tos-ota <source> <destination> -i 1 <tos_image.xml>  }}}
  * {{{<source>}}} is the serial port, e.g., serial@/dev/tty.usbserial-USB0:115200
  * {{{<destination>}}} is the id of the node.


== Installing the Metadata Collector Image on the Nodes' External Flash Memory (slot 0) ==
  * For each non-basestation node:
  * Change to nesC/MetadataCollector directory
  * Compile executable
  * Send the executable to the node at slot 0
  {{{tos-ota <source> <destination> -i 0 <tos_image.xml> }}}

= SNEE Lifecycle (automated) =
  Network initialisation, metadata data collection, query plan dissemination etc. can be invoked automatically by the the SNEE sensor network connectivity bridge. Just run the in-network client  in the SNEE project, without any parameters.

  Note that the initialisation file that is used is currently hard-coded.

= SNEE Lifecycle (standalone scripts) =
  You may wish to invoke the python standalone scripts to run the process manually.  Below is a summary of each command, in the order invoked by the SNEE SNCB.

  * init
    * This needs the metadata collector installed on the nodes' program memory.
    * Forms the network and collects metadata.
    {{{ init <topology_file> <basestation_id> }}}
  * register
    * (This assumes that the OTA image is in external flash slot 1)
    * Installs an image to a specific node.
    {{{ register <image absoulute path>  <dest node id>  <basestation_id> }}}
  * start
    * Initiates query execution.
    {{{ start }}}
  * stop
    * Stops query execution.
    {{{ stop <basestation id> }}}
  * deregister
    * Uninstalls a query image on a specific node.
    {{{ deregister <id1> <id2> ... <idn> <basestation_id> }}}